<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>USDNEAR Stablecoin</title>
    <link rel="stylesheet" href="css/hamb.css">
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/index.css">
</head>

<body>
    <div class="app">

        <div class="app-header">

            <div class="app-header-contents">
                <h2>USDNEAR Stablecoin</h2>
                <span id="connection-info" class="info-div">Not Connected</span>
            </div>
        </div>

        <div class="app-contents">

            <!-- Main Page, Dashboard -->
            <div id="initial-page" class="page slide-hide hidden">
                <h2 class="page-header">Welcome!</h2>

                <h3>Please connect a wallet to interact with this DApp</h3>

                <div id="main-buttons" class="footer button-group">
                    <button id="how-to-connect-a-wallet" class="button btn-primary">
                        How to connect a wallet
                    </button>
                </div>
            </div>

            <!-- Dashboard -->
            <div id="dashboard-page" class="page slide-hide hidden">
                <h2 class="page-header">Dashboard</h2>

                <div id="dashboard">
                </div>

                <div id="dashboard-buttons" class="footer button-group">
                    <button id="refresh-dashboard" class="button btn-primary">
                        Refresh Dashboard
                    </button>
                    <button id="enter-my-account" class="button btn-primary">
                        My Account
                    </button>
                </div>

                <!-- Dashboard Template -->
                <div id="dashboard-template" class="hidden label-value-content">
                    <div class="label-value">
                        <label>Location</label>
                        <div>{location}</div>
                    </div>
                    <div class="label-value">
                        <label>Total USDNEAR</label>
                        <div class="balance">{total_usdnear}</div>
                    </div>
                    <div class="label-value">
                        <label>Total Collateral stNEAR</label>
                        <div class="balance">{total_collateral_stnear}</div>
                    </div>
                    <div class="label-value">
                        <label>stNEAR price</label>
                        <div class="balance">{current_stnear_price}</div>
                    </div>
                    <div class="label-value">
                        <label>Valued Collateral</label>
                        <div class="balance">{valued_collateral}</div>
                    </div>
                    <div class="label-value">
                        <label>Total USDNEAR accounts</label>
                        <div class="number">{balances_count}</div>
                    </div>
                    <div class="label-value">
                        <label>Total borrowing accounts</label>
                        <div class="number">{b_accounts_count}</div>
                    </div>
                    <div class="label-value">
                        <label>USDNEAR Loan APR</label>
                        <div class="pct">{loan_apr}</div>
                    </div>
                </div>

            </div>

            <!-- My Account Page -->
            <div id="my-account" class="account-selected page slide-hide hidden">
                <header class="back-link">Back to Dashboard</header>
                <div id="my-account-info" class="my-account-info">
                </div>

                <!-- Template -->
                <div id="my-account-template" class="label-value-content hidden">
                    <div class="label-value">
                        <label>Account</label>
                        <div class="account">{nearAccount}</div>
                    </div>
                    <div class="group-title">Tokens</div>
                    <div id="available-balance-line" class="label-value">
                        <label>USDNEAR balance</label>
                        <div class="balance">{usdnear}</div>
                    </div>
                    <div id="available-balance-line" class="label-value">
                        <label>stNEAR balance</label>
                        <div class="balance">{stnear}</div>
                    </div>
                    <div class="group-title">Line of Credit</div>
                    <div id="available-balance-line" class="label-value">
                        <label>USDNEAR limit</label>
                        <div class="balance">{usdnear_credit_limit}</div>
                    </div>
                    <div class="group-title">Outstanding Loans</div>
                    <div class="label-value">
                        <label>Collateral stNEAR</label>
                        <div class="balance">{locked_stnear}</div>
                    </div>
                    
                    <div class="label-value">
                        <label>stNEAR price USD</label>
                        <div class="balance">{stnear_price_usd}</div>
                    </div>
                    <div class="label-value">
                        <label>Collateral Value USD</label>
                        <div class="balance">{valued_collateral_usd}</div>
                    </div>
                    <div class="label-value">
                        <label>Owed USDNEAR</label>
                        <div class="balance">{outstanding_loans_usdnear}</div>
                    </div>
                    <div class="label-value">
                        <label>Collateralization Ratio</label>
                        <div class="pct">{collateralization_ratio}</div>
                    </div>
                    <div class="label-value">
                        <label>Loan Status</label>
                        <div class="{loan_status_class}">{loan_status}</div>
                    </div>
                </div>


                <div id="my-account-supages" class="footer">

                    <!-- Buttons -->
                    <div id="account-selected-buttons" class="subpage hidden">
                        <div class="group-title">USDNEAR</div>
                        <div class="button-group">
                            <button id="send-usdnear">Send USDNEAR</button>
                            <button id="convert">Convert</button>
                        </div>
                        <div class="button-group no-top-line">
                            <button id="take-loan">Take USDNEAR Loan</button>
                            <button id="repay-loan">Repay Loan</button>
                        </div>
                        <div class="group-title">stNEAR</div>
                        <div class="button-group">
                            <button id="deposit">Deposit stNEAR</button>
                            <button id="withdraw">Withdraw stNEAR</button>
                        </div>
                        <div class="button-group no-top-line">
                            <button id="add-collateral">Add Collateral</button>
                            <button id="remove-collateral">Remove Collateral</button>
                        </div>
                        <div class="button-group">
                            <button id="refresh-account">Refresh Account</button>
                        </div>
                    </div>


                    <!-- SUBPAGES -->

                    <!-- subpage SEND USDNEAR -->
                    <div id="send-usdnear" class="subpage hidden">
                        <h2>Send USDNEAR</h2>
                        <div>
                            <div class="form-field-label">
                                <label for="send-receiver-account">
                                    Receiver Account
                                </label>
                                <div class="form-control">
                                    <input id="send-receiver-account" type="text">
                                </div>
                            </div>
                            <div class="form-field-label">
                                <label for="send-usdnear-amount">
                                USDNEAR amount to SEND (Max <span id="send-usdnear-max"></span>)
                                </label>
                                <div class="form-control">
                                    <input id="send-usdnear-amount" type="number">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- subpage SEND USDNEAR confirmation -->
                    <div id="send-confirmation" class="subpage hidden">
                        <h2>Confirm Send USDNEAR</h2>
                        <h3 class="warning">
                            Confirm send USDNEAR <span id="confirm-send-usdnear-amount"></span> to 
                            <span id="confirm-receiver-account"></span> ?
                        </h3>
                    </div>
                    
                    <!-- subpage Convert  -->
                    <div id="convert" class="subpage hidden">
                        <h2>Convert USDNEAR</h2>
                        <div>
                            <div class="form-field-label">
                                <label for="convert-usdnear-amount">
                                USDNEAR amount to convert to stNEAR (Max <span id="convert-usdnear-max"></span>)
                                </label>
                                <div class="form-control">
                                    <input id="convert-usdnear-amount" type="number">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- subpage CONVERT USDNEAR confirmation -->
                    <div id="send-confirmation" class="subpage hidden">
                        <h2>Confirm Convert USDNEAR</h2>
                        <h3 class="warning">
                            Confirm Convert USDNEAR <span id="confirm-convert-usdnear-amount"></span> 
                            into stNEAR <span id="confirm-convert-stnear-amount"></span> ?
                        </h3>
                    </div>

                    <!-- Deposit stNEAR -->
                    <div id="deposit-subpage" class="subpage hidden">
                        <h2>Deposit stNEAR</h2>
                        <div class="subtitle">
                            <h3 class="success">You need to deposit stNEAR in this smart contract to be able 
                                to mint USDNEAR. Your stNEAR will serve as collateral and can be liquidated. 
                                You keep earning your staking rewards minus loan interest.
                            </h3>
                        </div>
                        <div class="deposit-form">
                            <div class="form-field-label">
                                <label for="deposit-amount">
                                    Amount in stNEAR to deposit
                                </label>
                                <div class="form-control">
                                    <input id="deposit-amount" type="number">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- WITHDRAW stNEAR -->
                    <div id="withdraw-subpage" class="subpage hidden">
                        <h2>Withdraw stNEAR</h2>
                        <div class="subtitle">
                            <h3 class="success">You can withdraw stNEAR but it is preferable to keep loans overcollateralized to avoid liquidations.
                                You keep earning staking rewards for all your stNEAR in this contract. 
                                </h3>
                        </div>
                        <div class="withdraw-form">
                            <div class="form-field-label">
                                <label for="withdraw-amount">
                                    Amount in stNEAR to withdraw (Max <span id="max-withdraw"></span>)
                                </label>
                                <div class="form-control">
                                    <input id="withdraw-amount" type="number">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- subpage Take Loan -->
                    <div id="take-loan" class="subpage hidden">
                        <h2>Take USDNEAR Loan</h2>
                        <div>
                            <div class="form-field-label">
                                <label for="take-loan-amount">
                                    Amount in USDNEAR (Max <span id="credit-limit-usdnear"></span>)
                                </label>
                                <div class="form-control">
                                    <input id="take-loan-amount" type="number">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- subpage repay loan -->
                    <div id="repay-loan" class="subpage hidden">
                        <h2>Repay USDNEAR Loan</h2>
                        <div>
                            <div class="form-field-label">
                                <label for="repay-amount">
                                    USDNEAR Amount to repay (Max <span id="repay-usdnear-max"></span>)
                                </label>
                                <div class="form-control">
                                    <input id="repay-amount" type="number">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Add Collateral stNEAR -->
                    <div id="deposit-subpage" class="subpage hidden">
                        <h2>Add Collateral stNEAR</h2>
                        <div class="subtitle">
                            <h3 class="success">You add collateral to your outstanding loan. It is preferable to 
                                keep loans overcollateralized to avoid liquidations.
                                You keep earning staking rewards for all your stNEAR in this contract. 
                            </h3>
                        </div>
                        <div class="deposit-form">
                            <div class="form-field-label">
                                <label for="add-collateral-amount">
                                    stNEAR to add as collateral
                                </label>
                                <div class="form-control">
                                    <input id="add-collateral-amount" type="number">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Remove collateral stNEAR -->
                    <div id="withdraw-subpage" class="subpage hidden">
                        <h2>Remove Collateral stNEAR</h2>
                        <div class="subtitle">
                            <h3 class="success">You can remove excess collateral, but it is preferable to keep loans overcollateralized to avoid liquidations.
                                You keep earning staking rewards for all your stNEAR in this contract. 
                                </h3>
                        </div>
                        <div class="withdraw-form">
                            <div class="form-field-label">
                                <label for="remove-collateral-amount">
                                    stNEAR to remove from collateral (Max <span id="max-remove-collateral"></span>)
                                </label>
                                <div class="form-control">
                                    <input id="remove-collateral-amount" type="number">
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <div id="ok-cancel-placeholder" class="footer"></div>

            </div>

            <!-- OK CANCEL buttons component -->
            <div id="ok-cancel" class="component">
                <div class="button-group ok-cancel hidden no-top-line">
                    <button id="ok" class="button btn-primary">
                        OK
                    </button>
                    <button id="cancel" class="button btn-cancel">
                        Cancel
                    </button>
                </div>
            </div>


        </div> <!-- end app-contents -->
    </div> <!-- end app-->


    <!-- -->
    <div id="err-div"></div>
    <!-- -->
    <div id="wait">
        <div class="lds-ring">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>

    <script type="module" src="dist/index.js"></script>

</body>

</html>